// Notification message libraries - calm, cozy, and not pushy

export const DAILY_REMINDER = {
  standard: [
    {
      title: 'Coffee and Tandem? â˜•',
      body: 'Your daily puzzle pairs perfectly with morning brew',
    },
    {
      title: 'Brain Food ðŸ§ ',
      body: 'Four fresh emoji pairs served daily',
    },
    {
      title: 'Knock Knock ðŸ‘‹',
      body: "It's me, your daily Tandem puzzle!",
    },
    {
      title: 'Plot Twist! ðŸŽ¬',
      body: "Today's puzzle just dropped",
    },
    {
      title: 'Pssst... ðŸ¤«',
      body: 'New emoji mysteries to solve',
    },
    {
      title: 'Rise and Shine â˜€ï¸',
      body: 'Your brain workout is ready',
    },
    {
      title: 'Detective Mode: ON ðŸ”',
      body: 'Four emoji cases need solving',
    },
    {
      title: 'Fresh Out the Oven ðŸª',
      body: "Today's puzzle is warm and ready",
    },
    {
      title: "Puzzle O'Clock ðŸ•",
      body: 'Time for your daily Tandem fix',
    },
    {
      title: 'Mission Available ðŸŽ¯',
      body: 'Your emoji challenge awaits, agent',
    },
    {
      title: 'Hey You! ðŸ‘€',
      body: 'Yeah you. New puzzle alert',
    },
    {
      title: 'Breaking News ðŸ“°',
      body: 'Local puzzle needs solving immediately',
    },
  ],
  withStreak: [
    {
      title: 'Day {streak} Loading... ðŸ“ˆ',
      body: 'Your streak is looking legendary',
    },
    {
      title: '{streak} Days of Awesome ðŸ”¥',
      body: 'Keep that fire burning!',
    },
    {
      title: 'Streak Level: {streak} ðŸ’ª',
      body: "You're on a roll!",
    },
    {
      title: 'Chapter {streak} ðŸ“–',
      body: 'Your puzzle story continues',
    },
    {
      title: '{streak} in a Row! ðŸŽ¯',
      body: "Someone's unstoppable",
    },
    {
      title: 'Day {streak} Vibes âœ¨',
      body: 'Looking good, puzzle champion',
    },
    {
      title: 'Achievement Unlocking... ðŸ†',
      body: 'Day {streak} of greatness',
    },
    {
      title: '{streak} Days Strong ðŸ’¯',
      body: "You're basically a puzzle superhero now",
    },
  ],
  weekend: [
    {
      title: 'Weekend Vibes ðŸŒ´',
      body: 'Puzzle + Pajamas = Perfect Saturday',
    },
    {
      title: 'Lazy Mode: Activated ðŸ›‹ï¸',
      body: 'Your cozy puzzle is ready',
    },
    {
      title: 'Sunday Funday! ðŸŒž',
      body: 'Brunch and Tandem, anyone?',
    },
    {
      title: 'Weekend Special ðŸŽŠ',
      body: 'No rush, just puzzle bliss',
    },
    {
      title: 'Sleep In, Puzzle On ðŸ˜´',
      body: 'Your weekend brain treat awaits',
    },
    {
      title: 'Chill Mode ðŸ§˜',
      body: 'Four relaxing emoji pairs for you',
    },
  ],
};

export const STREAK_SAVER = {
  gentle: [
    {
      title: 'Streak Check! ðŸ”¥',
      body: "{streak} days going strong - don't break the chain!",
    },
    {
      title: 'Hey Superstar â­',
      body: 'Your {streak}-day streak is waiting for you',
    },
    {
      title: 'Quick Save? ðŸ’¾',
      body: 'Protect that beautiful {streak}-day streak',
    },
    {
      title: 'Friendly Ghost Here ðŸ‘»',
      body: 'Boo! Your {streak}-day streak needs you',
    },
    {
      title: 'Just Checking In ðŸ‘‹',
      body: '{streak} days is too good to lose!',
    },
    {
      title: 'Streak Guardian Alert ðŸ›¡ï¸',
      body: 'Defending your {streak}-day legacy',
    },
    {
      title: 'Still Awake? ðŸŒ™',
      body: 'Perfect time to save that {streak}-day streak',
    },
    {
      title: 'No Drama, But... ðŸŽ­',
      body: 'Your {streak}-day streak is getting lonely',
    },
    {
      title: 'Fortune Cookie Says ðŸ¥ ',
      body: 'A {streak}-day streak saved is a streak earned',
    },
    {
      title: 'Plot Armor Needed ðŸ¦¸',
      body: 'Save your {streak}-day hero streak!',
    },
  ],
  urgent: [
    {
      title: 'RED ALERT! ðŸš¨',
      body: '{streak} days at risk! {hours} hours to save it',
    },
    {
      title: "Clock's Ticking â°",
      body: 'Only {hours} hours left to save day {streak}!',
    },
    {
      title: 'Midnight Approaches ðŸ•°ï¸',
      body: 'Quick! Your {streak}-day streak expires soon',
    },
    {
      title: 'SOS! ðŸ†˜',
      body: 'Day {streak} needs rescuing ASAP',
    },
    {
      title: 'Final Boss Battle âš”ï¸',
      body: 'Defeat midnight, save your {streak}-day streak!',
    },
    {
      title: 'Mission Critical ðŸŽ¯',
      body: '{hours}h left - Operation Save Streak {streak}',
    },
  ],
};

export const MILESTONES = {
  week: [
    {
      title: 'WEEK COMPLETE! ðŸŽ‰',
      body: "7 days straight - you're officially amazing!",
    },
    {
      title: 'Level 7 Unlocked! ðŸŽ®',
      body: 'One whole week of puzzle greatness',
    },
    {
      title: 'Seven Day Superstar! â­',
      body: 'You just crushed a whole week!',
    },
    {
      title: 'Achievement Unlocked! ðŸ…',
      body: '7-day streak - feeling unstoppable yet?',
    },
  ],
  twoWeeks: [
    {
      title: 'FORTNIGHT CHAMPION! ðŸ‘‘',
      body: '14 days of pure awesome',
    },
    {
      title: 'Two Week Warrior! âš¡',
      body: "You're officially in the zone",
    },
    {
      title: 'Double Digits! ðŸŽŠ',
      body: '14 days and absolutely crushing it',
    },
    {
      title: 'Legendary Status! ðŸŒŸ',
      body: 'Two weeks of puzzle domination',
    },
  ],
  month: [
    {
      title: 'MONTH CONQUERED! ðŸ†',
      body: "30 days! You're a puzzle phenomenon!",
    },
    {
      title: 'Monthly Master! ðŸŽ¯',
      body: 'An entire month - simply incredible',
    },
    {
      title: '30 Day Legend! ðŸ”¥',
      body: "You've officially reached greatness",
    },
    {
      title: 'Hall of Fame! ðŸŒŸ',
      body: '30 days of dedication - WOW!',
    },
  ],
  fiftyDays: [
    {
      title: 'HALF CENTURY! ðŸŽŠ',
      body: "50 days! You're basically superhuman",
    },
    {
      title: 'Elite Status Achieved! ðŸ’Ž',
      body: 'Welcome to the 50-day club!',
    },
    {
      title: 'Fifty & Fabulous! âœ¨',
      body: 'This streak is absolutely legendary',
    },
    {
      title: 'Golden Milestone! ðŸ…',
      body: '50 days of pure excellence',
    },
  ],
  hundredDays: [
    {
      title: 'CENTURY COMPLETE! ðŸ’¯',
      body: '100 DAYS! You absolute legend!',
    },
    {
      title: 'Triple Digit Titan! ðŸ‘‘',
      body: 'Welcome to puzzle immortality',
    },
    {
      title: '100 Day Hero! ðŸ¦¸',
      body: 'This achievement is beyond epic',
    },
    {
      title: 'LEGENDARY STATUS! ðŸŒŸ',
      body: "100 days - you've made history!",
    },
  ],
};

export const WEEKLY_SUMMARY = [
  {
    title: 'Weekly Check-In',
    body: 'You completed {played} puzzles this week. Great work! ðŸŽ‰',
  },
  {
    title: 'Your Week in Tandem',
    body: '{played} puzzles solved this week. Keep it up! ðŸŒŸ',
  },
  {
    title: 'Weekly Recap',
    body: 'Amazing! You completed {played} puzzles this week ðŸŽ¯',
  },
  {
    title: 'Sunday Summary',
    body: '{played} puzzles conquered this week. Fantastic job! ðŸ†',
  },
  {
    title: 'Week Complete',
    body: 'Nice work! You finished {played} puzzles this week ðŸ’ª',
  },
  {
    title: 'Weekly Achievement',
    body: 'You solved {played} puzzles this week. Awesome progress! âœ¨',
  },
];

export const COMEBACK = [
  {
    title: "Look Who's Back! ðŸŽ‰",
    body: 'We saved your favorite emoji pairs',
  },
  {
    title: 'The Return! ðŸ¦¸',
    body: 'Your puzzle powers have been recharged',
  },
  {
    title: 'Missed You! ðŸ¤—',
    body: 'Ready to jump back into the fun?',
  },
  {
    title: 'Hey Stranger! ðŸ‘‹',
    body: 'Perfect timing - fresh puzzle just dropped',
  },
  {
    title: 'Welcome Home! ðŸ ',
    body: 'Your daily brain workout missed you',
  },
  {
    title: 'Plot Twist! ðŸŽ¬',
    body: 'The hero returns for another puzzle',
  },
  {
    title: 'No Judgment Zone ðŸŒˆ',
    body: "Just happy you're here - let's play!",
  },
  {
    title: 'Fresh Start Vibes âœ¨',
    body: 'New day, new puzzle, new possibilities',
  },
];

// Helper function to get random message from category
export function getRandomMessage(category, subcategory = null) {
  const messages = subcategory ? category[subcategory] : category;
  if (!messages || messages.length === 0) return null;
  return messages[Math.floor(Math.random() * messages.length)];
}

// Helper function to replace placeholders in message
export function formatMessage(message, data = {}) {
  if (!message) return message;

  const formattedMessage = { ...message };

  // Replace placeholders in title and body
  Object.keys(data).forEach((key) => {
    const placeholder = `{${key}}`;
    // Handle undefined/null values - convert to string to avoid "undefined" text
    const value = data[key] !== undefined && data[key] !== null ? String(data[key]) : '';

    if (formattedMessage.title) {
      // Use replaceAll to replace ALL occurrences, not just the first
      formattedMessage.title = formattedMessage.title.replaceAll(placeholder, value);
    }
    if (formattedMessage.body) {
      // Use replaceAll to replace ALL occurrences, not just the first
      formattedMessage.body = formattedMessage.body.replaceAll(placeholder, value);
    }
  });

  // Validation: check for unreplaced placeholders and warn
  const unreplacedPattern = /\{[^}]+\}/g;
  const titleHasUnreplaced =
    formattedMessage.title && unreplacedPattern.test(formattedMessage.title);
  const bodyHasUnreplaced = formattedMessage.body && unreplacedPattern.test(formattedMessage.body);

  if (titleHasUnreplaced || bodyHasUnreplaced) {
    console.warn('[NotificationMessages] Unreplaced placeholders detected:', {
      title: formattedMessage.title,
      body: formattedMessage.body,
      providedData: data,
    });
  }

  return formattedMessage;
}

// Get appropriate daily reminder based on context
export function getDailyReminder(context = {}) {
  const { streak, isWeekend } = context;

  let message;
  if (isWeekend) {
    message = getRandomMessage(DAILY_REMINDER.weekend);
  } else if (streak && streak > 0) {
    message = getRandomMessage(DAILY_REMINDER.withStreak);
    message = formatMessage(message, { streak });
  } else {
    message = getRandomMessage(DAILY_REMINDER.standard);
  }

  return message;
}

// Get streak saver message based on urgency
export function getStreakSaverMessage(streak, hoursLeft) {
  const isUrgent = hoursLeft <= 3;
  const category = isUrgent ? STREAK_SAVER.urgent : STREAK_SAVER.gentle;

  let message = getRandomMessage(category);
  message = formatMessage(message, {
    streak,
    hours: Math.floor(hoursLeft),
  });

  return message;
}

// Get milestone message
export function getMilestoneMessage(days) {
  let category;

  switch (days) {
    case 7:
      category = MILESTONES.week;
      break;
    case 14:
      category = MILESTONES.twoWeeks;
      break;
    case 30:
      category = MILESTONES.month;
      break;
    case 50:
      category = MILESTONES.fiftyDays;
      break;
    case 100:
      category = MILESTONES.hundredDays;
      break;
    default:
      return null;
  }

  return getRandomMessage(category);
}
